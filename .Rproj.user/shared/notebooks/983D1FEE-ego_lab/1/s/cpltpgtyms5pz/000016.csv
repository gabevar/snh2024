"0","aa_data <- gss %>% "
"0","  select(ego_id, matches(""close"")) %>% "
"0","  group_by(ego_id) %>% "
"0","  pivot_longer(-ego_id) %>% "
"0","  separate(name, into = c(""name"", ""to""), sep = -1) %>% # remember to split up twice here"
"0","  separate(name, into = c(""name"", ""from""), sep = -1) %>% "
"0","  select(-name) %>% # remove useful column"
"0","  mutate(from = as.numeric(from), to = as.numeric(to)) %>% "
"0","  filter(value > 0 & !is.na(value))"
"0",""
"0","head(aa_data)"
